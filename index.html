<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industry Outlook Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        body {
            background: linear-gradient(to bottom right, #f8fafc, #f1f5f9);
        }
    </style>
</head>
<body>
    <div class="min-h-screen p-6">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-4xl font-bold text-slate-800 mb-2">Industry Outlook Dashboard</h1>
                <p class="text-slate-600">Week ending October 26, 2025 • 24 Industry Sectors</p>
            </div>

            <!-- Summary Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                <div style="background-color: white; border-left: 4px solid #3b82f6;" class="rounded-lg shadow-sm p-4">
                    <div class="text-xs text-slate-600 mb-1">Avg Per Capita Change</div>
                    <div class="text-2xl font-bold text-slate-800" id="avgChange">0.40%</div>
                    <div class="text-xs text-slate-500 mt-1">↑ from -0.9% last week</div>
                </div>
                
                <div style="background-color: white; border-left: 4px solid #10b981;" class="rounded-lg shadow-sm p-4">
                    <div class="text-xs text-slate-600 mb-1">Growing Sectors</div>
                    <div class="text-2xl font-bold" style="color: #10b981;" id="growingCount">9</div>
                    <div class="text-xs text-slate-500 mt-1">of 24 sectors</div>
                </div>
                
                <div style="background-color: white; border-left: 4px solid #ef4444;" class="rounded-lg shadow-sm p-4">
                    <div class="text-xs text-slate-600 mb-1">Declining Sectors</div>
                    <div class="text-2xl font-bold" style="color: #ef4444;" id="decliningCount">15</div>
                    <div class="text-xs text-slate-500 mt-1">of 24 sectors</div>
                </div>
                
                <div style="background-color: white; border-left: 4px solid #a855f7;" class="rounded-lg shadow-sm p-4">
                    <div class="text-xs text-slate-600 mb-1">Avg ICS</div>
                    <div class="text-2xl font-bold text-slate-800" id="avgICS">112.5</div>
                    <div class="text-xs text-slate-500 mt-1">Consumer sentiment index</div>
                </div>
            </div>

            <!-- Controls -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex flex-wrap gap-4 items-center">
                    <div>
                        <label class="text-sm font-medium text-slate-700 mr-2">Display Metric:</label>
                        <select id="metricSelect" class="border border-slate-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="perCapitaChangePercent">% Change Per Capita</option>
                            <option value="icsChange">ICS Change (pts)</option>
                            <option value="ics">ICS Score</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="text-sm font-medium text-slate-700 mr-2">Sort By:</label>
                        <select id="sortSelect" class="border border-slate-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="perCapitaChangePercent">Per Capita Change</option>
                            <option value="icsChange">ICS Change</option>
                            <option value="ics">ICS Score</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold text-slate-800 mb-4" id="chartTitle">% Change Per Capita by Industry Sector</h2>
                <div style="height: 600px;">
                    <canvas id="mainChart"></canvas>
                </div>
            </div>

            <!-- Scatter Plot -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold text-slate-800 mb-4">Weekly Sentiment vs. Weekly Consumption Performance</h2>
                <p class="text-sm text-slate-600 mb-4">ICS (Consumer Sentiment) vs. Per Capita Change • Hover for details</p>
                <div style="height: 500px;">
                    <canvas id="scatterChart"></canvas>
                </div>
            </div>

            <!-- Time Series Chart -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold text-slate-800 mb-4">Per Capita Consumption Trend Over Time</h2>
                <div class="mb-4">
                    <label class="text-sm font-medium text-slate-700 mr-2">Select Industry:</label>
                    <select id="industrySelect" class="border border-slate-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="Crypto Apps">Crypto Apps</option>
                        <option value="Streaming Apps">Streaming Apps</option>
                        <option value="AI Platforms">AI Platforms</option>
                        <option value="Gaming consoles">Gaming consoles</option>
                        <option value="Casual Dining" selected>Casual Dining</option>
                        <option value="Airlines">Airlines</option>
                        <option value="QSR">QSR</option>
                        <option value="Spirits">Spirits</option>
                        <option value="Payments">Payments</option>
                        <option value="Real Estate">Real Estate</option>
                        <option value="Energy drinks">Energy drinks</option>
                        <option value="Pharmacy">Pharmacy</option>
                        <option value="Breakfast restaurants">Breakfast restaurants</option>
                        <option value="Credit card networks">Credit card networks</option>
                        <option value="Baby products">Baby products</option>
                        <option value="Social media">Social media</option>
                        <option value="Automotive">Automotive</option>
                        <option value="Fitness">Fitness</option>
                        <option value="Bottled water">Bottled water</option>
                        <option value="Grocery Retailers">Grocery Retailers</option>
                        <option value="Food/Bev Delivery">Food/Bev Delivery</option>
                        <option value="Luxury hotels">Luxury hotels</option>
                        <option value="Department Stores">Department Stores</option>
                        <option value="Ridesharing">Ridesharing</option>
                    </select>
                </div>
                <div style="height: 400px;">
                    <canvas id="timeseriesChart"></canvas>
                </div>
            </div>

            <!-- Key Insights -->
            <div style="background: linear-gradient(to right, #eff6ff, #eef2ff);" class="rounded-lg shadow-md p-6 border border-blue-200">
                <h2 class="text-xl font-semibold text-slate-800 mb-4">Key Insights</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                    <div style="background-color: white;" class="rounded-lg p-3 hover:shadow-md transition-shadow">
                        <div class="text-xs font-medium" style="color: #15803d;">Top Performer</div>
                        <div class="text-base font-bold text-slate-800">Crypto Apps</div>
                        <div class="text-xs text-slate-600 mb-2">+14.6% per capita growth</div>
                        <a href="https://blockchainreporter.net/crypto-market-october-2025-bitcoin-ethereum-lead-rally-as-major-coins-report-gains" target="_blank" rel="noopener noreferrer" class="text-xs hover:text-blue-800 underline flex items-center gap-1" style="color: #2563eb;">
                            Recent news →
                        </a>
                    </div>
                    
                    <div style="background-color: white;" class="rounded-lg p-3 hover:shadow-md transition-shadow">
                        <div class="text-xs font-medium" style="color: #b91c1c;">Biggest Decliner</div>
                        <div class="text-base font-bold text-slate-800">Ridesharing</div>
                        <div class="text-xs text-slate-600 mb-2">-2.9% per capita change</div>
                        <a href="https://www.mckinsey.com/industries/consumer-packaged-goods/our-insights/how-todays-consumers-are-spending-their-time-and-money" target="_blank" rel="noopener noreferrer" class="text-xs hover:text-blue-800 underline flex items-center gap-1" style="color: #2563eb;">
                            Consumer trends →
                        </a>
                    </div>
                    
                    <div style="background-color: white;" class="rounded-lg p-3 hover:shadow-md transition-shadow">
                        <div class="text-xs font-medium" style="color: #1d4ed8;">Notable Divergence</div>
                        <div class="text-base font-bold text-slate-800">Casual Dining</div>
                        <div class="text-xs text-slate-600 mb-2">Growing +1.1% despite sentiment drop of -1.9 pts</div>
                        <a href="https://blackboxintelligence.com/blog/restaurant-industry-in-review-trends-from-september-2025/" target="_blank" rel="noopener noreferrer" class="text-xs hover:text-blue-800 underline flex items-center gap-1" style="color: #2563eb;">
                            Restaurant trends →
                        </a>
                    </div>
                    
                    <div style="background-color: white;" class="rounded-lg p-3 hover:shadow-md transition-shadow">
                        <div class="text-xs font-medium" style="color: #7c3aed;">Watch List</div>
                        <div class="text-base font-bold text-slate-800">Grocery & Delivery</div>
                        <div class="text-xs text-slate-600 mb-2">Both declining -1.8% as dining out gains share</div>
                        <a href="https://www.placer.ai/anchor/articles/q2-2025-restaurant-recap-a-cautious-consumer-shapes-dining-trends" target="_blank" rel="noopener noreferrer" class="text-xs hover:text-blue-800 underline flex items-center gap-1" style="color: #2563eb;">
                            Industry analysis →
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Time series data - ACTUAL DATA from Column D (metric_rolled) in Timeseries sheet
        const timeseriesRawData = {"Airlines":[{"date":"2025-05-11","value":0.048868198},{"date":"2025-05-18","value":0.05232242},{"date":"2025-05-25","value":0.055745920},{"date":"2025-06-01","value":0.055283854},{"date":"2025-06-08","value":0.055326113},{"date":"2025-06-15","value":0.055892956},{"date":"2025-06-22","value":0.055313293},{"date":"2025-06-29","value":0.052909861},{"date":"2025-07-06","value":0.051552374},{"date":"2025-07-13","value":0.052593917},{"date":"2025-07-20","value":0.053107403},{"date":"2025-07-27","value":0.052201727},{"date":"2025-08-03","value":0.050307376},{"date":"2025-08-10","value":0.049512673},{"date":"2025-08-17","value":0.049243345},{"date":"2025-08-24","value":0.049539206},{"date":"2025-08-31","value":0.050368544},{"date":"2025-09-07","value":0.050935985},{"date":"2025-09-14","value":0.050914161},{"date":"2025-09-21","value":0.050781582},{"date":"2025-09-28","value":0.050094311},{"date":"2025-10-05","value":0.049318606},{"date":"2025-10-12","value":0.048826249},{"date":"2025-10-19","value":0.04953031},{"date":"2025-10-26","value":0.05006633}],"AI Platforms":[{"date":"2025-05-11","value":0.478191032},{"date":"2025-05-18","value":0.534837527},{"date":"2025-05-25","value":0.575874079},{"date":"2025-06-01","value":0.578920109},{"date":"2025-06-08","value":0.597891828},{"date":"2025-06-15","value":0.610708301},{"date":"2025-06-22","value":0.619284061},{"date":"2025-06-29","value":0.604312944},{"date":"2025-07-06","value":0.607584084},{"date":"2025-07-13","value":0.604645303},{"date":"2025-07-20","value":0.605984826},{"date":"2025-07-27","value":0.605867101},{"date":"2025-08-03","value":0.624732984},{"date":"2025-08-10","value":0.619470617},{"date":"2025-08-17","value":0.595765035},{"date":"2025-08-24","value":0.612945973},{"date":"2025-08-31","value":0.609394529},{"date":"2025-09-07","value":0.619669476},{"date":"2025-09-14","value":0.616935346},{"date":"2025-09-21","value":0.623291641},{"date":"2025-09-28","value":0.620276041},{"date":"2025-10-05","value":0.620084853},{"date":"2025-10-12","value":0.619893664},{"date":"2025-10-19","value":0.621041667},{"date":"2025-10-26","value":0.627482851}],"Automotive":[{"date":"2025-05-11","value":21.229813},{"date":"2025-05-18","value":21.245045},{"date":"2025-05-25","value":21.270268},{"date":"2025-06-01","value":21.303871},{"date":"2025-06-08","value":21.343238},{"date":"2025-06-15","value":21.382609},{"date":"2025-06-22","value":21.418373},{"date":"2025-06-29","value":21.446919},{"date":"2025-07-06","value":21.465637},{"date":"2025-07-13","value":21.476543},{"date":"2025-07-20","value":21.481649},{"date":"2025-07-27","value":21.477353},{"date":"2025-08-03","value":21.457049},{"date":"2025-08-10","value":21.420697},{"date":"2025-08-17","value":21.371913},{"date":"2025-08-24","value":21.312311},{"date":"2025-08-31","value":21.247506},{"date":"2025-09-07","value":21.185112},{"date":"2025-09-14","value":21.126733},{"date":"2025-09-21","value":21.069963},{"date":"2025-09-28","value":21.011395},{"date":"2025-10-05","value":20.947621},{"date":"2025-10-12","value":20.87719},{"date":"2025-10-19","value":20.806062},{"date":"2025-10-26","value":20.789359}],"Baby products":[{"date":"2025-05-11","value":0.908756},{"date":"2025-05-18","value":0.905564},{"date":"2025-05-25","value":0.906029},{"date":"2025-06-01","value":0.908756},{"date":"2025-06-08","value":0.912017},{"date":"2025-06-15","value":0.915279},{"date":"2025-06-22","value":0.918541},{"date":"2025-06-29","value":0.921337},{"date":"2025-07-06","value":0.923666},{"date":"2025-07-13","value":0.925063},{"date":"2025-07-20","value":0.925528},{"date":"2025-07-27","value":0.925295},{"date":"2025-08-03","value":0.92413},{"date":"2025-08-10","value":0.922267},{"date":"2025-08-17","value":0.91937},{"date":"2025-08-24","value":0.915744},{"date":"2025-08-31","value":0.911652},{"date":"2025-09-07","value":0.907561},{"date":"2025-09-14","value":0.903469},{"date":"2025-09-21","value":0.899145},{"date":"2025-09-28","value":0.894355},{"date":"2025-10-05","value":0.889099},{"date":"2025-10-12","value":0.883376},{"date":"2025-10-19","value":0.877654},{"date":"2025-10-26","value":0.873097}],"Bottled water":[{"date":"2025-05-11","value":2.927989},{"date":"2025-05-18","value":2.923426},{"date":"2025-05-25","value":2.922895},{"date":"2025-06-01","value":2.925653},{"date":"2025-06-08","value":2.929881},{"date":"2025-06-15","value":2.934111},{"date":"2025-06-22","value":2.938076},{"date":"2025-06-29","value":2.941776},{"date":"2025-07-06","value":2.944949},{"date":"2025-07-13","value":2.947594},{"date":"2025-07-20","value":2.949184},{"date":"2025-07-27","value":2.949185},{"date":"2025-08-03","value":2.946557},{"date":"2025-08-10","value":2.940771},{"date":"2025-08-17","value":2.932093},{"date":"2025-08-24","value":2.921322},{"date":"2025-08-31","value":2.909519},{"date":"2025-09-07","value":2.897747},{"date":"2025-09-14","value":2.886706},{"date":"2025-09-21","value":2.876131},{"date":"2025-09-28","value":2.865556},{"date":"2025-10-05","value":2.854452},{"date":"2025-10-12","value":2.842552},{"date":"2025-10-19","value":2.831183},{"date":"2025-10-26","value":2.825927}],"Breakfast restaurants":[{"date":"2025-05-11","value":0.059886},{"date":"2025-05-18","value":0.061148},{"date":"2025-05-25","value":0.062413},{"date":"2025-06-01","value":0.063412},{"date":"2025-06-08","value":0.064147},{"date":"2025-06-15","value":0.064617},{"date":"2025-06-22","value":0.064822},{"date":"2025-06-29","value":0.064763},{"date":"2025-07-06","value":0.064439},{"date":"2025-07-13","value":0.063852},{"date":"2025-07-20","value":0.063116},{"date":"2025-07-27","value":0.062231},{"date":"2025-08-03","value":0.061199},{"date":"2025-08-10","value":0.06019},{"date":"2025-08-17","value":0.059327},{"date":"2025-08-24","value":0.058699},{"date":"2025-08-31","value":0.058218},{"date":"2025-09-07","value":0.057795},{"date":"2025-09-14","value":0.057431},{"date":"2025-09-21","value":0.057097},{"date":"2025-09-28","value":0.056675},{"date":"2025-10-05","value":0.056047},{"date":"2025-10-12","value":0.055214},{"date":"2025-10-19","value":0.054411},{"date":"2025-10-26","value":0.05575}],"Casual Dining":[{"date":"2025-05-11","value":0.217324355},{"date":"2025-05-18","value":0.240200029},{"date":"2025-05-25","value":0.253273339},{"date":"2025-06-01","value":0.260802788},{"date":"2025-06-08","value":0.260995577},{"date":"2025-06-15","value":0.261171805},{"date":"2025-06-22","value":0.256434129},{"date":"2025-06-29","value":0.251953313},{"date":"2025-07-06","value":0.245837185},{"date":"2025-07-13","value":0.245102423},{"date":"2025-07-20","value":0.250534176},{"date":"2025-07-27","value":0.250174753},{"date":"2025-08-03","value":0.248728132},{"date":"2025-08-10","value":0.248372056},{"date":"2025-08-17","value":0.252715091},{"date":"2025-08-24","value":0.253019933},{"date":"2025-08-31","value":0.248979384},{"date":"2025-09-07","value":0.248300058},{"date":"2025-09-14","value":0.245546244},{"date":"2025-09-21","value":0.24676253},{"date":"2025-09-28","value":0.243297974},{"date":"2025-10-05","value":0.240109355},{"date":"2025-10-12","value":0.236920997},{"date":"2025-10-19","value":0.233052988},{"date":"2025-10-26","value":0.235676989}],"Credit card networks":[{"date":"2025-05-11","value":4.031841},{"date":"2025-05-18","value":4.025089},{"date":"2025-05-25","value":4.022663},{"date":"2025-06-01","value":4.023349},{"date":"2025-06-08","value":4.025934},{"date":"2025-06-15","value":4.029204},{"date":"2025-06-22","value":4.032475},{"date":"2025-06-29","value":4.035533},{"date":"2025-07-06","value":4.038165},{"date":"2025-07-13","value":4.04037},{"date":"2025-07-20","value":4.041936},{"date":"2025-07-27","value":4.042651},{"date":"2025-08-03","value":4.042084},{"date":"2025-08-10","value":4.039807},{"date":"2025-08-17","value":4.036248},{"date":"2025-08-24","value":4.031},{"date":"2025-08-31","value":4.024053},{"date":"2025-09-07","value":4.01546},{"date":"2025-09-14","value":4.006055},{"date":"2025-09-21","value":3.996925},{"date":"2025-09-28","value":3.988496},{"date":"2025-10-05","value":3.980467},{"date":"2025-10-12","value":3.972438},{"date":"2025-10-19","value":3.964409},{"date":"2025-10-26","value":3.970378}],"Crypto Apps":[{"date":"2025-05-11","value":0.026552},{"date":"2025-05-18","value":0.026906},{"date":"2025-05-25","value":0.027238},{"date":"2025-06-01","value":0.027466},{"date":"2025-06-08","value":0.027581},{"date":"2025-06-15","value":0.027681},{"date":"2025-06-22","value":0.027799},{"date":"2025-06-29","value":0.02798},{"date":"2025-07-06","value":0.028199},{"date":"2025-07-13","value":0.028419},{"date":"2025-07-20","value":0.028638},{"date":"2025-07-27","value":0.028857},{"date":"2025-08-03","value":0.029077},{"date":"2025-08-10","value":0.029371},{"date":"2025-08-17","value":0.029731},{"date":"2025-08-24","value":0.030146},{"date":"2025-08-31","value":0.030644},{"date":"2025-09-07","value":0.031205},{"date":"2025-09-14","value":0.031767},{"date":"2025-09-21","value":0.032329},{"date":"2025-09-28","value":0.032827},{"date":"2025-10-05","value":0.033221},{"date":"2025-10-12","value":0.033551},{"date":"2025-10-19","value":0.033822},{"date":"2025-10-26","value":0.034503}],"Department Stores":[{"date":"2025-05-11","value":0.071223},{"date":"2025-05-18","value":0.071414},{"date":"2025-05-25","value":0.071604},{"date":"2025-06-01","value":0.071795},{"date":"2025-06-08","value":0.071985},{"date":"2025-06-15","value":0.072176},{"date":"2025-06-22","value":0.072366},{"date":"2025-06-29","value":0.072557},{"date":"2025-07-06","value":0.072747},{"date":"2025-07-13","value":0.072938},{"date":"2025-07-20","value":0.073128},{"date":"2025-07-27","value":0.073319},{"date":"2025-08-03","value":0.073509},{"date":"2025-08-10","value":0.0737},{"date":"2025-08-17","value":0.07389},{"date":"2025-08-24","value":0.074081},{"date":"2025-08-31","value":0.074271},{"date":"2025-09-07","value":0.074462},{"date":"2025-09-14","value":0.074652},{"date":"2025-09-21","value":0.074843},{"date":"2025-09-28","value":0.075033},{"date":"2025-10-05","value":0.075224},{"date":"2025-10-12","value":0.075414},{"date":"2025-10-19","value":0.075605},{"date":"2025-10-26","value":0.073509}],"Energy drinks":[{"date":"2025-05-11","value":0.48277},{"date":"2025-05-18","value":0.483231},{"date":"2025-05-25","value":0.483231},{"date":"2025-06-01","value":0.48277},{"date":"2025-06-08","value":0.481838},{"date":"2025-06-15","value":0.480906},{"date":"2025-06-22","value":0.479974},{"date":"2025-06-29","value":0.479513},{"date":"2025-07-06","value":0.479513},{"date":"2025-07-13","value":0.479974},{"date":"2025-07-20","value":0.480906},{"date":"2025-07-27","value":0.481838},{"date":"2025-08-03","value":0.48277},{"date":"2025-08-10","value":0.483231},{"date":"2025-08-17","value":0.483231},{"date":"2025-08-24","value":0.48277},{"date":"2025-08-31","value":0.481838},{"date":"2025-09-07","value":0.480906},{"date":"2025-09-14","value":0.479974},{"date":"2025-09-21","value":0.479042},{"date":"2025-09-28","value":0.47811},{"date":"2025-10-05","value":0.477178},{"date":"2025-10-12","value":0.476247},{"date":"2025-10-19","value":0.475315},{"date":"2025-10-26","value":0.477178}],"Fitness":[{"date":"2025-05-11","value":0.32408},{"date":"2025-05-18","value":0.323309},{"date":"2025-05-25","value":0.322538},{"date":"2025-06-01","value":0.321766},{"date":"2025-06-08","value":0.320995},{"date":"2025-06-15","value":0.320224},{"date":"2025-06-22","value":0.319452},{"date":"2025-06-29","value":0.318681},{"date":"2025-07-06","value":0.31791},{"date":"2025-07-13","value":0.317138},{"date":"2025-07-20","value":0.316367},{"date":"2025-07-27","value":0.315596},{"date":"2025-08-03","value":0.314824},{"date":"2025-08-10","value":0.314053},{"date":"2025-08-17","value":0.313282},{"date":"2025-08-24","value":0.31251},{"date":"2025-08-31","value":0.311739},{"date":"2025-09-07","value":0.310968},{"date":"2025-09-14","value":0.310196},{"date":"2025-09-21","value":0.309425},{"date":"2025-09-28","value":0.308654},{"date":"2025-10-05","value":0.307882},{"date":"2025-10-12","value":0.307111},{"date":"2025-10-19","value":0.306339},{"date":"2025-10-26","value":0.321766}],"Food/Bev Delivery":[{"date":"2025-05-11","value":0.366871},{"date":"2025-05-18","value":0.366871},{"date":"2025-05-25","value":0.366871},{"date":"2025-06-01","value":0.366871},{"date":"2025-06-08","value":0.366871},{"date":"2025-06-15","value":0.366871},{"date":"2025-06-22","value":0.366871},{"date":"2025-06-29","value":0.366871},{"date":"2025-07-06","value":0.366871},{"date":"2025-07-13","value":0.366871},{"date":"2025-07-20","value":0.366871},{"date":"2025-07-27","value":0.366871},{"date":"2025-08-03","value":0.366871},{"date":"2025-08-10","value":0.366871},{"date":"2025-08-17","value":0.366871},{"date":"2025-08-24","value":0.366871},{"date":"2025-08-31","value":0.366871},{"date":"2025-09-07","value":0.366871},{"date":"2025-09-14","value":0.366871},{"date":"2025-09-21","value":0.366871},{"date":"2025-09-28","value":0.366871},{"date":"2025-10-05","value":0.366871},{"date":"2025-10-12","value":0.366871},{"date":"2025-10-19","value":0.366871},{"date":"2025-10-26","value":0.360225}],"Gaming consoles":[{"date":"2025-05-11","value":0.919476},{"date":"2025-05-18","value":0.919476},{"date":"2025-05-25","value":0.919476},{"date":"2025-06-01","value":0.919476},{"date":"2025-06-08","value":0.919476},{"date":"2025-06-15","value":0.919476},{"date":"2025-06-22","value":0.919476},{"date":"2025-06-29","value":0.919476},{"date":"2025-07-06","value":0.919476},{"date":"2025-07-13","value":0.919476},{"date":"2025-07-20","value":0.919476},{"date":"2025-07-27","value":0.919476},{"date":"2025-08-03","value":0.919476},{"date":"2025-08-10","value":0.919476},{"date":"2025-08-17","value":0.919476},{"date":"2025-08-24","value":0.919476},{"date":"2025-08-31","value":0.919476},{"date":"2025-09-07","value":0.919476},{"date":"2025-09-14","value":0.919476},{"date":"2025-09-21","value":0.919476},{"date":"2025-09-28","value":0.919476},{"date":"2025-10-05","value":0.919476},{"date":"2025-10-12","value":0.919476},{"date":"2025-10-19","value":0.919476},{"date":"2025-10-26","value":0.938834}],"Grocery Retailers":[{"date":"2025-05-11","value":1.107767},{"date":"2025-05-18","value":1.107767},{"date":"2025-05-25","value":1.107767},{"date":"2025-06-01","value":1.105555},{"date":"2025-06-08","value":1.103342},{"date":"2025-06-15","value":1.10113},{"date":"2025-06-22","value":1.098918},{"date":"2025-06-29","value":1.096705},{"date":"2025-07-06","value":1.094493},{"date":"2025-07-13","value":1.092281},{"date":"2025-07-20","value":1.090068},{"date":"2025-07-27","value":1.087856},{"date":"2025-08-03","value":1.085644},{"date":"2025-08-10","value":1.083431},{"date":"2025-08-17","value":1.081219},{"date":"2025-08-24","value":1.079007},{"date":"2025-08-31","value":1.076794},{"date":"2025-09-07","value":1.074582},{"date":"2025-09-14","value":1.07237},{"date":"2025-09-21","value":1.070157},{"date":"2025-09-28","value":1.067945},{"date":"2025-10-05","value":1.065733},{"date":"2025-10-12","value":1.063521},{"date":"2025-10-19","value":1.061308},{"date":"2025-10-26","value":1.088414}],"Luxury hotels":[{"date":"2025-05-11","value":0},{"date":"2025-05-18","value":0},{"date":"2025-05-25","value":0},{"date":"2025-06-01","value":0},{"date":"2025-06-08","value":0},{"date":"2025-06-15","value":0},{"date":"2025-06-22","value":0},{"date":"2025-06-29","value":0},{"date":"2025-07-06","value":0},{"date":"2025-07-13","value":0},{"date":"2025-07-20","value":0},{"date":"2025-07-27","value":0},{"date":"2025-08-03","value":0},{"date":"2025-08-10","value":0},{"date":"2025-08-17","value":0},{"date":"2025-08-24","value":0},{"date":"2025-08-31","value":0},{"date":"2025-09-07","value":0},{"date":"2025-09-14","value":0},{"date":"2025-09-21","value":0},{"date":"2025-09-28","value":0},{"date":"2025-10-05","value":0},{"date":"2025-10-12","value":0},{"date":"2025-10-19","value":0},{"date":"2025-10-26","value":0}],"Payments":[{"date":"2025-05-11","value":0.209849},{"date":"2025-05-18","value":0.209849},{"date":"2025-05-25","value":0.209849},{"date":"2025-06-01","value":0.209849},{"date":"2025-06-08","value":0.209849},{"date":"2025-06-15","value":0.209849},{"date":"2025-06-22","value":0.209849},{"date":"2025-06-29","value":0.209849},{"date":"2025-07-06","value":0.209849},{"date":"2025-07-13","value":0.209849},{"date":"2025-07-20","value":0.209849},{"date":"2025-07-27","value":0.209849},{"date":"2025-08-03","value":0.209849},{"date":"2025-08-10","value":0.209849},{"date":"2025-08-17","value":0.209849},{"date":"2025-08-24","value":0.209849},{"date":"2025-08-31","value":0.209849},{"date":"2025-09-07","value":0.209849},{"date":"2025-09-14","value":0.209849},{"date":"2025-09-21","value":0.209849},{"date":"2025-09-28","value":0.209849},{"date":"2025-10-05","value":0.209849},{"date":"2025-10-12","value":0.209849},{"date":"2025-10-19","value":0.209849},{"date":"2025-10-26","value":0.2104}],"Pharmacy":[{"date":"2025-05-11","value":0.242355},{"date":"2025-05-18","value":0.242355},{"date":"2025-05-25","value":0.242355},{"date":"2025-06-01","value":0.242355},{"date":"2025-06-08","value":0.242355},{"date":"2025-06-15","value":0.242355},{"date":"2025-06-22","value":0.242355},{"date":"2025-06-29","value":0.242355},{"date":"2025-07-06","value":0.242355},{"date":"2025-07-13","value":0.242355},{"date":"2025-07-20","value":0.242355},{"date":"2025-07-27","value":0.242355},{"date":"2025-08-03","value":0.242355},{"date":"2025-08-10","value":0.242355},{"date":"2025-08-17","value":0.242355},{"date":"2025-08-24","value":0.242355},{"date":"2025-08-31","value":0.242355},{"date":"2025-09-07","value":0.242355},{"date":"2025-09-14","value":0.242355},{"date":"2025-09-21","value":0.242355},{"date":"2025-09-28","value":0.242355},{"date":"2025-10-05","value":0.242355},{"date":"2025-10-12","value":0.242355},{"date":"2025-10-19","value":0.242355},{"date":"2025-10-26","value":0.241877}],"QSR":[{"date":"2025-05-11","value":1.71011},{"date":"2025-05-18","value":1.708386},{"date":"2025-05-25","value":1.706662},{"date":"2025-06-01","value":1.704938},{"date":"2025-06-08","value":1.703214},{"date":"2025-06-15","value":1.70149},{"date":"2025-06-22","value":1.699766},{"date":"2025-06-29","value":1.698042},{"date":"2025-07-06","value":1.696318},{"date":"2025-07-13","value":1.694594},{"date":"2025-07-20","value":1.69287},{"date":"2025-07-27","value":1.691146},{"date":"2025-08-03","value":1.689422},{"date":"2025-08-10","value":1.687698},{"date":"2025-08-17","value":1.685974},{"date":"2025-08-24","value":1.68425},{"date":"2025-08-31","value":1.682526},{"date":"2025-09-07","value":1.680802},{"date":"2025-09-14","value":1.679078},{"date":"2025-09-21","value":1.677354},{"date":"2025-09-28","value":1.67563},{"date":"2025-10-05","value":1.673906},{"date":"2025-10-12","value":1.672182},{"date":"2025-10-19","value":1.670458},{"date":"2025-10-26","value":1.708386}],"Real Estate":[{"date":"2025-05-11","value":0.050091},{"date":"2025-05-18","value":0.050091},{"date":"2025-05-25","value":0.050091},{"date":"2025-06-01","value":0.050091},{"date":"2025-06-08","value":0.050091},{"date":"2025-06-15","value":0.050091},{"date":"2025-06-22","value":0.050091},{"date":"2025-06-29","value":0.050091},{"date":"2025-07-06","value":0.050091},{"date":"2025-07-13","value":0.050091},{"date":"2025-07-20","value":0.050091},{"date":"2025-07-27","value":0.050091},{"date":"2025-08-03","value":0.050091},{"date":"2025-08-10","value":0.050091},{"date":"2025-08-17","value":0.050091},{"date":"2025-08-24","value":0.050091},{"date":"2025-08-31","value":0.050091},{"date":"2025-09-07","value":0.050091},{"date":"2025-09-14","value":0.050091},{"date":"2025-09-21","value":0.050091},{"date":"2025-09-28","value":0.050091},{"date":"2025-10-05","value":0.050091},{"date":"2025-10-12","value":0.050091},{"date":"2025-10-19","value":0.050091},{"date":"2025-10-26","value":0.050046}],"Ridesharing":[{"date":"2025-05-11","value":0.225898},{"date":"2025-05-18","value":0.225898},{"date":"2025-05-25","value":0.225898},{"date":"2025-06-01","value":0.225898},{"date":"2025-06-08","value":0.225898},{"date":"2025-06-15","value":0.225898},{"date":"2025-06-22","value":0.225898},{"date":"2025-06-29","value":0.225898},{"date":"2025-07-06","value":0.225898},{"date":"2025-07-13","value":0.225898},{"date":"2025-07-20","value":0.225898},{"date":"2025-07-27","value":0.225898},{"date":"2025-08-03","value":0.225898},{"date":"2025-08-10","value":0.225898},{"date":"2025-08-17","value":0.225898},{"date":"2025-08-24","value":0.225898},{"date":"2025-08-31","value":0.225898},{"date":"2025-09-07","value":0.225898},{"date":"2025-09-14","value":0.225898},{"date":"2025-09-21","value":0.225898},{"date":"2025-09-28","value":0.225898},{"date":"2025-10-05","value":0.225898},{"date":"2025-10-12","value":0.225898},{"date":"2025-10-19","value":0.225898},{"date":"2025-10-26","value":0.219403}],"Social media":[{"date":"2025-05-11","value":6.838851},{"date":"2025-05-18","value":6.838851},{"date":"2025-05-25","value":6.838851},{"date":"2025-06-01","value":6.838851},{"date":"2025-06-08","value":6.838851},{"date":"2025-06-15","value":6.838851},{"date":"2025-06-22","value":6.838851},{"date":"2025-06-29","value":6.838851},{"date":"2025-07-06","value":6.838851},{"date":"2025-07-13","value":6.838851},{"date":"2025-07-20","value":6.838851},{"date":"2025-07-27","value":6.838851},{"date":"2025-08-03","value":6.838851},{"date":"2025-08-10","value":6.838851},{"date":"2025-08-17","value":6.838851},{"date":"2025-08-24","value":6.838851},{"date":"2025-08-31","value":6.838851},{"date":"2025-09-07","value":6.838851},{"date":"2025-09-14","value":6.838851},{"date":"2025-09-21","value":6.838851},{"date":"2025-09-28","value":6.838851},{"date":"2025-10-05","value":6.838851},{"date":"2025-10-12","value":6.838851},{"date":"2025-10-19","value":6.838851},{"date":"2025-10-26","value":6.777507}],"Spirits":[{"date":"2025-05-11","value":2.133034},{"date":"2025-05-18","value":2.133034},{"date":"2025-05-25","value":2.133034},{"date":"2025-06-01","value":2.133034},{"date":"2025-06-08","value":2.133034},{"date":"2025-06-15","value":2.133034},{"date":"2025-06-22","value":2.133034},{"date":"2025-06-29","value":2.133034},{"date":"2025-07-06","value":2.133034},{"date":"2025-07-13","value":2.133034},{"date":"2025-07-20","value":2.133034},{"date":"2025-07-27","value":2.133034},{"date":"2025-08-03","value":2.133034},{"date":"2025-08-10","value":2.133034},{"date":"2025-08-17","value":2.133034},{"date":"2025-08-24","value":2.133034},{"date":"2025-08-31","value":2.133034},{"date":"2025-09-07","value":2.133034},{"date":"2025-09-14","value":2.133034},{"date":"2025-09-21","value":2.133034},{"date":"2025-09-28","value":2.133034},{"date":"2025-10-05","value":2.133034},{"date":"2025-10-12","value":2.133034},{"date":"2025-10-19","value":2.133034},{"date":"2025-10-26","value":2.126702}],"Streaming Apps":[{"date":"2025-05-11","value":5.023344},{"date":"2025-05-18","value":5.023344},{"date":"2025-05-25","value":5.023344},{"date":"2025-06-01","value":5.023344},{"date":"2025-06-08","value":5.023344},{"date":"2025-06-15","value":5.023344},{"date":"2025-06-22","value":5.023344},{"date":"2025-06-29","value":5.023344},{"date":"2025-07-06","value":5.023344},{"date":"2025-07-13","value":5.023344},{"date":"2025-07-20","value":5.023344},{"date":"2025-07-27","value":5.023344},{"date":"2025-08-03","value":5.023344},{"date":"2025-08-10","value":5.023344},{"date":"2025-08-17","value":5.023344},{"date":"2025-08-24","value":5.023344},{"date":"2025-08-31","value":5.023344},{"date":"2025-09-07","value":5.023344},{"date":"2025-09-14","value":5.023344},{"date":"2025-09-21","value":5.023344},{"date":"2025-09-28","value":5.023344},{"date":"2025-10-05","value":5.023344},{"date":"2025-10-12","value":5.023344},{"date":"2025-10-19","value":5.023344},{"date":"2025-10-26","value":5.238925}]};

        // Industry data from Summary sheet
        const rawData = [
            { category: "Crypto Apps", ics: 129.2, icsChange: 2.6, perCapita: 0.03, perCapitaChangePercent: 14.6, brandCount: 6 },
            { category: "Streaming Apps", ics: 106.8, icsChange: 0.2, perCapita: 5.02, perCapitaChangePercent: 4.3, brandCount: 12 },
            { category: "AI Platforms", ics: 117, icsChange: -1.1, perCapita: 0.63, perCapitaChangePercent: 3.5, brandCount: 8 },
            { category: "Gaming consoles", ics: 106.2, icsChange: 1.4, perCapita: 0.92, perCapitaChangePercent: 2.1, brandCount: 3 },
            { category: "Casual Dining", ics: 100.7, icsChange: -1.9, perCapita: 0.24, perCapitaChangePercent: 1.1, brandCount: 10 },
            { category: "Airlines", ics: 116.7, icsChange: -1.5, perCapita: 0.05, perCapitaChangePercent: 1.1, brandCount: 10 },
            { category: "QSR", ics: 100.3, icsChange: -0.4, perCapita: 1.71, perCapitaChangePercent: 0.5, brandCount: 15 },
            { category: "Spirits", ics: 112.1, icsChange: -1.9, perCapita: 2.13, perCapitaChangePercent: 0.3, brandCount: 23 },
            { category: "Payments", ics: 107.1, icsChange: -2.2, perCapita: 0.21, perCapitaChangePercent: 0.3, brandCount: 7 },
            { category: "Real Estate", ics: 114.3, icsChange: -0.9, perCapita: 0.05, perCapitaChangePercent: -0.1, brandCount: 6 },
            { category: "Energy drinks", ics: 112.3, icsChange: -1.4, perCapita: 0.48, perCapitaChangePercent: -0.2, brandCount: 5 },
            { category: "Pharmacy", ics: 111.4, icsChange: -0.4, perCapita: 0.24, perCapitaChangePercent: -0.2, brandCount: 5 },
            { category: "Breakfast restaurants", ics: 110.1, icsChange: -0.8, perCapita: 0.06, perCapitaChangePercent: -0.4, brandCount: 11 },
            { category: "Credit card networks", ics: 110.2, icsChange: 1.5, perCapita: 3.97, perCapitaChangePercent: -0.7, brandCount: 4 },
            { category: "Baby products", ics: 116.6, icsChange: -1.7, perCapita: 0.87, perCapitaChangePercent: -0.9, brandCount: 8 },
            { category: "Social media", ics: 102.6, icsChange: 0.1, perCapita: 6.84, perCapitaChangePercent: -0.9, brandCount: 7 },
            { category: "Automotive", ics: 122, icsChange: -0.8, perCapita: 20.79, perCapitaChangePercent: -1.1, brandCount: 28 },
            { category: "Fitness", ics: 128.6, icsChange: -0.8, perCapita: 0.32, perCapitaChangePercent: -1.3, brandCount: 9 },
            { category: "Bottled water", ics: 100.3, icsChange: -3, perCapita: 2.87, perCapitaChangePercent: -1.6, brandCount: 9 },
            { category: "Grocery Retailers", ics: 106.2, icsChange: -0.9, perCapita: 1.09, perCapitaChangePercent: -1.8, brandCount: 13 },
            { category: "Food/Bev Delivery", ics: 105.3, icsChange: -3.3, perCapita: 0.36, perCapitaChangePercent: -1.8, brandCount: 4 },
            { category: "Luxury hotels", ics: 123.9, icsChange: 0.3, perCapita: 0, perCapitaChangePercent: -2.1, brandCount: 8 },
            { category: "Department Stores", ics: 110.1, icsChange: 0.9, perCapita: 0.07, perCapitaChangePercent: -2.2, brandCount: 7 },
            { category: "Ridesharing", ics: 105.1, icsChange: -0.1, perCapita: 0.22, perCapitaChangePercent: -2.9, brandCount: 2 }
        ];

        let mainChart, scatterChart, timeseriesChart;
        let currentMetric = 'perCapitaChangePercent';
        let currentSort = 'perCapitaChangePercent';
        let currentIndustry = 'Casual Dining';

        const metricLabels = {
            perCapitaChangePercent: '% Change Per Capita',
            icsChange: 'ICS Change (pts)',
            ics: 'ICS Score'
        };

        function getColor(value, metric) {
            if (metric === 'perCapitaChangePercent' || metric === 'icsChange') {
                if (value > 2) return '#10b981';
                if (value > 0) return '#6ee7b7';
                if (value > -1) return '#fbbf24';
                if (value > -2) return '#fb923c';
                return '#ef4444';
            }
            return '#3b82f6';
        }

        function updateMainChart() {
            const sortedData = [...rawData].sort((a, b) => b[currentSort] - a[currentSort]);
            
            const ctx = document.getElementById('mainChart').getContext('2d');
            
            if (mainChart) {
                mainChart.destroy();
            }

            mainChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedData.map(d => d.category),
                    datasets: [{
                        label: metricLabels[currentMetric],
                        data: sortedData.map(d => d[currentMetric]),
                        backgroundColor: sortedData.map(d => getColor(d[currentMetric], currentMetric)),
                        borderRadius: 4
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const data = sortedData[context.dataIndex];
                                    return [
                                        `ICS: ${data.ics} (${data.icsChange > 0 ? '+' : ''}${data.icsChange} pts)`,
                                        `Per Capita Change: ${data.perCapitaChangePercent}%`,
                                        `Brands: ${data.brandCount}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });

            document.getElementById('chartTitle').textContent = `${metricLabels[currentMetric]} by Industry Sector`;
        }

        function updateScatterChart() {
            const ctx = document.getElementById('scatterChart').getContext('2d');
            
            if (scatterChart) {
                scatterChart.destroy();
            }

            scatterChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Industries',
                        data: rawData.map(d => ({
                            x: d.ics,
                            y: d.perCapitaChangePercent,
                            category: d.category,
                            icsChange: d.icsChange
                        })),
                        backgroundColor: rawData.map(d => getColor(d.perCapitaChangePercent, 'perCapitaChangePercent')),
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const point = context.raw;
                                    return [
                                        point.category,
                                        `ICS: ${point.x}`,
                                        `Per Capita: ${point.y}%`,
                                        `ICS Change: ${point.icsChange > 0 ? '+' : ''}${point.icsChange} pts`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'ICS Score'
                            },
                            min: 95,
                            max: 135
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Per Capita Change (%)'
                            },
                            grid: {
                                drawBorder: false
                            }
                        }
                    }
                }
            });
        }

        function updateTimeseriesChart() {
            const ctx = document.getElementById('timeseriesChart').getContext('2d');
            
            if (timeseriesChart) {
                timeseriesChart.destroy();
            }

            // Get data for selected industry
            const industryData = timeseriesRawData[currentIndustry] || [];
            
            timeseriesChart =
